<div style="padding: 20px;">
  <h1>Incident Pulse Test UI</h1>
  
  <form [formGroup]="testForm" (ngSubmit)="runTests()">
    <div>
      <label for="host">Host/URL:</label>
      <input id="host" formControlName="host" placeholder="e.g., google.com or http://google.com" required>
    </div>
    
    <div>
      <label for="testType">Test Type:</label>
      <select id="testType" formControlName="testType" required>
        <option value="ping">Ping</option>
        <option value="traceroute">Traceroute</option>
        <option value="dns">DNS</option>
        <option value="http">HTTP</option>
      </select>
    </div>
    
    <div>
      <label for="count">Count:</label>
      <input id="count" type="number" formControlName="count" required>
    </div>
    
    <div>
      <label for="timeoutSeconds">Timeout Seconds:</label>
      <input id="timeoutSeconds" type="number" formControlName="timeoutSeconds" required>
    </div>
    
    <div>
      <label for="locations">Locations (comma-separated):</label>
      <input id="locations" formControlName="locations" placeholder="e.g., us-east-1,us-west-2" required>
    </div>
    
    <button type="submit" [disabled]="running">Run Tests</button>
    <button type="button" (click)="stopTests()" [disabled]="!running">Stop Tests</button>
  </form>
  
  <div *ngIf="running" class="progress-container">
    <span>Test Completion: {{ progress | number:'1.0-0' }}%</span>
    <progress [value]="progress" max="100"></progress>
    <button type="button" (click)="stopTests()" [disabled]="!running">Stop</button>
  </div>
  
  <div *ngIf="results.length > 0">
    <h2>Test Results</h2>
    <div *ngFor="let res of results">
      <h3>Location: {{ res.location || 'Default' }}</h3>
      <div *ngIf="res.error; else showStats">
        <p>Error: {{ res.error }}</p>
      </div>
      <ng-template #showStats>
        <p>Status: {{ res.status }}</p>
        <p>Raw Output:</p>
        <pre>{{ res.rawOutput }}</pre>
        <p>Parsed Result:</p>
        <pre>{{ res.parsedResult | json }}</pre>
      </ng-template>
    </div>
  </div>
</div>


form div {
  margin-bottom: 10px;
}

pre {
  background-color: #f4f4f4;
  padding: 10px;
  border: 1px solid #ddd;
  overflow-x: auto;
}

.progress-container {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-top: 10px;
}

.progress-container span {
  white-space: nowrap;
}

.progress-container progress {
  flex-grow: 1;
}

.progress-container button {
  padding: 5px 10px;
}
